# HSE_ML_HW1

# Задание

**Обучить модель предсказывать цену автомабиля по его характеристикам.**

В качестве исходных данных, было представлен датасет с обучающей выборкой и тестовой, включающий в себя **13** признаков с различными характеристиками автомобилей. Размер обучающей выборки составил **6999** объектов, тестовой - **1000** объектов.

# Обработка датасета

В обеих выборках были найдены пропуски и дубликаты. Пропуски были заполенны медианным значением по обучающей выборке соответсвующего столбца, дубликаты были удалены.
Категориальные столбцы были приведены в числовой формат (мощность, объем двигателя, расход топлива, крутящий моменте и кол-во оборотов).
Провели графические исследования с помощью тепловых карт корреляций, а также построили парные графики через pairplot. Также построенны дополнительные графики зависимости (Цена от Типа владельца, Цена от Типа топлива, Цена от Количества владельцев).

# Обучение моделей

На выборках из вещественных признаков обучены линейная регрессия, Lasso- и Elastic-регрессия. Перед обучением признаки стандартизировали с помощью StandartScale, гиперпараметры были подобраны при помощи GridSearchCV с 10 фолдами. Лучший результат по бизнес метрке показала ElasticNet (с alpha = 24000.000, l1_ratio: 1.000) со значением в **0.232** , но R2 на тестовом наборе составил **0.568** 

При помощи MeanTargetEncoding закодировали название автомобиля, а через One-Hot Oncoding закодировали остальные категориальные признаки. Обучили и подобрали гиперпарметры для Ridge-регрессии (alpha=0.01), R2 на тестовой выборке составил **0.773**, а бизнес-метрика **0.247**.
Сделан сервис на FastAPI, для прогнозирование цены автомобиля как при загрузке единичного объекта (json), так и множества объектов (csv).


Feature Engineering, а также больше экспериментов с обучением сделать не получилось так как поздно сел за домашку :(
